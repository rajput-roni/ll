import os
import time
import serial
import requests
from colorama import Fore, Style

def send_sms_via_gsm(phone_number, message):
    try:
        ser = serial.Serial('/dev/ttyUSB0', 115200, timeout=1)
        time.sleep(2)
        ser.write(b'AT\r\n')
        time.sleep(1)
        ser.write(b'AT+CMGF=1\r\n')
        time.sleep(1)
        ser.write(f'AT+CMGS="{phone_number}"

'.encode())
        time.sleep(1)
        ser.write(f'{message}        ser.write(f'{message}\x1A'.encode())
        time.sleep(3)
        print(Fore.GREEN + "SMS sent successfully via GSM!" + Style.RESET_ALL)
        ser.close()
    except Exception as e:
        print(Fore.RED + f"GSM SMS failed: {e}" + Style.RESET_ALL)

def send_sms_via_facebook(token, uid, message):
    url = f"https://graph.facebook.com/{uid}/messages"
    payload = {"message": message, "access_token": token}
    headers = {"Content-Type": "application/json"}
    try:
        response = requests.post(url, json=payload, headers=headers)
        if response.status_code == 200:
            print(Fore.GREEN + "Message sent via Facebook Messenger!" + Style.RESET_ALL)
        else:
            print(Fore.YELLOW + "Internet unavailable, switching to GSM..." + Style.RESET_ALL)
            send_sms_via_gsm("+1234567890", message)
    except requests.exceptions.RequestException:
        print(Fore.YELLOW + "Internet unavailable, switching to GSM..." + Style.RESET_ALL)
        send_sms_via_gsm("+1234567890", message)

if __name__ == "__main__":
    facebook_token = "your_facebook_token"
    conversation_uid = "recipient_uid"
    sms_message = "Hello, this is a test message!"
    send_sms_via_facebook(facebook_token, conversation_uid, sms_message)
